# üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –±—ç–∫–∞–ø–æ–≤ MMKV

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é MMKV **–ù–ï –∏—Å–∫–ª—é—á–∞–µ—Ç** –¥–∞–Ω–Ω—ã–µ –∏–∑ iCloud –±—ç–∫–∞–ø–æ–≤, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç AsyncStorage. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ç–æ–∫–µ–Ω—ã, –ø–∞—Ä–æ–ª–∏) –º–æ–≥—É—Ç –ø–æ–ø–∞—Å—Ç—å –≤ iCloud.

## –†–µ—à–µ–Ω–∏–µ

–ú—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ MMKV —Ñ–∞–π–ª–æ–≤ –∏–∑ iCloud –±—ç–∫–∞–ø–æ–≤ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. iOS (iCloud)

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Info.plist:
```xml
<key>NSURLIsExcludedFromBackupKey</key>
<true/>
```

#### –ù–∞—Ç–∏–≤–Ω—ã–π –º–æ–¥—É–ª—å:
- **`ios/bpsenergy/MMKVBackupExclusion.h`** - –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª
- **`ios/bpsenergy/MMKVBackupExclusion.m`** - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
```objc
// –ò—Å–∫–ª—é—á–∞–µ—Ç –≤—Å—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é MMKV –∏–∑ iCloud –±—ç–∫–∞–ø–æ–≤
+ (void)excludeMMKVFromBackup
{
  // –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ MMKV
  NSString *mmkvPath = [documentsDirectory stringByAppendingPathComponent:@"mmkv"];
  
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
  [mmkvURL setResourceValue:@YES
                    forKey:NSURLIsExcludedFromBackupKey
                     error:&error];
}
```

### 2. Android (Google Drive)

MMKV –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Google Drive –±—ç–∫–∞–ø–æ–≤, —Ç–∞–∫ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∫–æ–¥–µ

### JavaScript/TypeScript:
```typescript
import { NativeModules, Platform } from 'react-native';

const { MMKVBackupExclusion } = NativeModules;

const excludeFromBackup = async () => {
  if (Platform.OS === 'ios' && MMKVBackupExclusion) {
    try {
      await MMKVBackupExclusion.excludeFromBackup();
      console.log('MMKV: Successfully excluded from iCloud backup');
    } catch (error) {
      console.error('MMKV: Failed to exclude from iCloud backup:', error);
    }
  }
};
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ:
```typescript
// –í src/utils/mmkv.ts
export const storage = new MMKV({
  id: 'bpsenergy-storage',
});

// –ò—Å–∫–ª—é—á–∞–µ–º —Ñ–∞–π–ª –∏–∑ iCloud –±—ç–∫–∞–ø–æ–≤ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
excludeFromBackup();
```

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å AsyncStorage

| –§—É–Ω–∫—Ü–∏—è | AsyncStorage | MMKV |
|---------|-------------|------|
| **iCloud –±—ç–∫–∞–ø—ã** | ‚ùå –ò—Å–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω —á–µ—Ä–µ–∑ –Ω–∞—Ç–∏–≤–Ω—ã–π –º–æ–¥—É–ª—å |
| **Google Drive –±—ç–∫–∞–ø—ã** | ‚ùå –ò—Å–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | üêå –ú–µ–¥–ª–µ–Ω–Ω—ã–π | ‚ö° –ë—ã—Å—Ç—Ä—ã–π |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π |

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### iOS:
1. –û—Ç–∫—Ä–æ–π—Ç–µ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **iCloud** ‚Üí **–•—Ä–∞–Ω–∏–ª–∏—â–µ** ‚Üí **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ MMKV –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ –±—ç–∫–∞–ø

### Android:
1. –û—Ç–∫—Ä–æ–π—Ç–µ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **Google** ‚Üí **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ –±—ç–∫–∞–ø

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ª–æ–≥–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç—É—Å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏–∑ –±—ç–∫–∞–ø–æ–≤:

```
‚úÖ MMKV: Successfully excluded from iCloud backup
‚ùå MMKV: Failed to exclude from iCloud backup: [error]
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

### –ß—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è –∏–∑ –±—ç–∫–∞–ø–æ–≤:
- ‚úÖ –¢–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ Refresh —Ç–æ–∫–µ–Ω—ã
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ö—ç—à –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### –ß—Ç–æ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –±—ç–∫–∞–ø–∞—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- ‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è (–µ—Å–ª–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–æ–≤ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
2. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
3. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ** –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ–ª–∏—Ç–∏–∫–µ –±—ç–∫–∞–ø–æ–≤
4. **–ò–Ω—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –æ –ø–æ–ª–∏—Ç–∏–∫–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

‚úÖ **MMKV —Ç–µ–ø–µ—Ä—å –±–µ–∑–æ–ø–∞—Å–µ–Ω** - –¥–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ iCloud –±—ç–∫–∞–ø–æ–≤
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –≤ 10-100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ AsyncStorage  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –æ–±–ª–∞–∫–æ
‚úÖ **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ iOS –∏ Android 